{% load static %}
{% block head %}
<!-- Carrega o arquivo de estilo CSS -->
<link rel="stylesheet" href="{% static 'css/styles_gen.css' %}" />
{% endblock %}

{% block content %}
<!-- Início da barra de ferramentas personalizada -->
<div class="stiJsViewerToolBar">
  <!-- Div que encapsula o conteúdo da barra de ferramentas -->
  <div style="padding: 2px">
    <!-- Tabela principal da barra de ferramentas -->
    <table class="stiJsViewerToolBarTable" cellpadding="0" cellspacing="0" style="margin: 0px; font-family: Arial">
      <tbody>
        <!-- Primeira linha da tabela que contém os botões -->
        <tr class="stiJsViewerClearAllStyles">
          <!-- Primeira célula da tabela, que ocupa toda a largura -->
          <td class="stiJsViewerClearAllStyles" style="width: 100%">
            <!-- Tabela interna para organizar os botões -->
            <table class="stiJsViewerClearAllStyles" cellpadding="0" cellspacing="0" align="Default" style="margin: 1px">
              <tbody>
                <tr class="stiJsViewerClearAllStyles">
                  <!-- Botão de Imprimir -->
                  <td class="stiJsViewerClearAllStyles">
                    <div
                      id="printButton"
                      class="stiJsViewerStandartSmallButton stiJsViewerStandartSmallButtonDefault"
                      style="font-family: Arial; height: 23px; box-sizing: content-box; margin: 1px;"
                    >
                      <table class="stiJsViewerClearAllStyles" cellpadding="0" cellspacing="0" style="height: 100%">
                        <tbody>
                          <tr class="stiJsViewerClearAllStyles">
                            <td class="stiJsViewerClearAllStyles" style="line-height: 0; padding: 0px 3px">
                              <img src="{% static 'img/print.png' %}" />
                            </td>
                            <td class="stiJsViewerClearAllStyles" style="padding: 1px 5px 0px 0px; white-space: nowrap; text-align: left;">
                              Imprimir
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </td>
                  <!-- Fim do botão de Imprimir -->

                  <!-- Botão de Salvar -->
                  <td>
                    <div
                      class="stiJsViewerStandartSmallButton stiJsViewerStandartSmallButtonDefault"
                      style="font-family: Arial; height: 23px; box-sizing: content-box; margin: 1px;"
                    >
                      <table cellpadding="0" cellspacing="0" style="height: 100%">
                        <tbody>
                          <tr>
                            <td style="line-height: 0; padding: 0px 3px">
                              <img src="{% static 'img/save.png' %}" />
                            </td>
                            <td style="padding: 1px 0px 0px; white-space: nowrap; text-align: left;">
                              Salvar
                            </td>
                            <td style="padding: 0px 5px">
                              <img
                                id="saveButton"
                                src="{% static 'img/save_down.png' %}"
                                style="margin-top: 1px; vertical-align: baseline; cursor: pointer;"
                                onclick="toggleDropdown()"
                              />
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <!-- Dropdown de opções -->
                    <div id="saveDropdown">
                      <a onclick="saveAsPDF()">Salvar como PDF</a>
                      <a onclick="saveAsExcel()">Salvar como Excel</a>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- Fim da barra de ferramentas personalizada -->
</div>

<!-- Início do script para funcionalidades -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
<script>
  // Função para gerar o PDF quando o botão de imprimir for clicado
  document.getElementById('printButton').addEventListener('click', function () {
    // Seleciona o conteúdo da div que você quer incluir no PDF
    const element = document.getElementById('relatorio-container');  // Altere 'relatorio-container' para o ID correto

    // Usa html2pdf.js para gerar o PDF a partir do conteúdo HTML
    html2pdf()
      .from(element)  // Passa o conteúdo da div para o html2pdf
      .save('relatorio_de_demandas.pdf');  // Nome do arquivo PDF
  });

  // Função para alternar a visibilidade do dropdown
  function toggleDropdown() {
    var dropdown = document.getElementById('saveDropdown');
    dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
  }

  // Função para salvar como Excel (exemplo simples)
  function saveAsExcel() {
    alert('Salvar como Excel');
    // Lógica para salvar como Excel
    document.getElementById('saveDropdown').style.display = 'none'; // Esconde o dropdown
  }

  // Função para salvar como PDF (exemplo simples)
  function saveAsPDF() {
    alert('Salvar como PDF');
    // Lógica para salvar como PDF
    document.getElementById('saveDropdown').style.display = 'none'; // Esconde o dropdown
  }

</script>
{% endblock %}
